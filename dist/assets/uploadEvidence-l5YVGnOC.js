import{K as w,r,d as E,D as k,j as e,Q as T,N as L,T as u,E as h,Y as x,S as i,G as f,F as V,O as B,U as G,V as I,W as M,X as O,H as P}from"./index-rASeH_eV.js";import{F as R}from"./form-provider-JHl3Tohf.js";import{U as W}from"./upload-avatar-N8WOxGjq.js";import{L as Y}from"./LoadingButton-rGoJ8b66.js";import"./format-number-w1N-Z0Z4.js";import"./transition-Uc7vb3zK.js";function H(){const j=w(),[y,g]=r.useState(""),[c,d]=r.useState([null,null,null,null,null]),_=()=>f.success("Your Document Uploaded"),m=()=>f.error("Failed to Upload"),b=r.useMemo(()=>({doc_type_0:"",doc_type_1:"",doc_type_2:"",doc_type_3:"",doc_type_4:""}),[]),l=E({defaultValues:b}),{handleSubmit:S,control:F}=l,v=sessionStorage.getItem("vendor");r.useEffect(()=>{g(v||"")},[]);const p=S(async n=>{const o=c.map((t,a)=>{if(t){const s=new FormData;return s.append("doc_type",n[`doc_type_${a}`]),s.append("vendor_code",y),s.append("file",t),s}return null}).filter(t=>t!==null);try{(await Promise.all(o.map(s=>k.post("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/upload_document",s,{headers:{"Content-Type":"multipart/form-data"}})))).every(s=>s.data.status==="201")?_():m()}catch(t){console.error("Error submitting form:",t),m()}}),D=[{label:"Milling Unit Photo",key:"milling_unit_photo"},{label:"Milling Unit Video",key:"milling_unit_video"}],U=r.useCallback(n=>o=>{const t=o[0];t&&d(a=>{const s=[...a];return s[n]=Object.assign(t,{preview:URL.createObjectURL(t)}),s})},[]),C=n=>e.jsx(V,{children:e.jsx(i,{spacing:3,sx:{p:3},children:e.jsxs(i,{spacing:1.5,children:[e.jsx(h,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(2, 1fr)"},children:e.jsx(B,{name:`doc_type_${n}`,control:F,render:({field:o})=>e.jsxs(G,{fullWidth:!0,children:[e.jsx(I,{children:"Document Type"}),e.jsx(M,{...o,label:"Document Type",children:D.map(t=>e.jsx(O,{value:t.key,children:t.label},t.key))})]})})}),e.jsx(u,{variant:"subtitle2",children:"Upload Your Document"}),e.jsx(W,{file:c[n],onDrop:U(n),onDelete:()=>d(o=>{const t=[...o];return t[n]=null,t})})]})})},n);return e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsxs(L,{maxWidth:j.themeStretch?!1:"xl",children:[e.jsx(u,{variant:"h4",children:"Evidence"}),e.jsx(h,{sx:{mt:5,width:1,borderRadius:2},children:e.jsxs(R,{methods:l,onSubmit:p,children:[e.jsx(x,{container:!0,spacing:5,children:Array.from({length:5}).map((n,o)=>e.jsx(x,{item:!0,xs:12,sm:6,md:4,children:C(o)},o))}),e.jsx(i,{alignItems:"flex-end",sx:{mt:3},children:e.jsx(Y,{type:"submit",className:"button",loading:l.formState.isSubmitting,onClick:p,children:"Save"})})]})})]})]})}function X(){return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx("title",{children:" Dashboard: Upload Evidence"})}),e.jsx(H,{})]})}export{X as default};
